# EigenFactor调整样本协方差矩阵

定义主动收益率
$$
f_m=r_m-R_t^M
$$
其中$r_m$是股票在第$t$天的收益率向量。$R_t^M$是$t$天的市场收益率，一般会定义为股票的市值加权收益率。根据性质，对$f_m$进行市值加权的结果等于0。

接下来定义样本协方差矩阵
$$
V_0(mn)=\frac{1}{T-1}\sum_{t=1}^T{(f_{mt}-\overline{f_m})(f_{nt}-\overline{f_n})}
$$
其中$T=200$。这里写成了矩阵中每个元素的形式。下标$m$和$n$表示第$m$和$n$只股票。

我们接着定义偏差统计量，用于判断协方差矩阵预测风险的能力强弱。

定义$R_t$为投资组合在第$t$天的收益率，$\sigma_t$为在$t$天给出的波动率预测。利用$\sigma_t$对收益率进行标准化，得到z值
$$
b_t=\frac{R_t}{\sigma_t}
$$
z值得标准差就是偏差统计量
$$
B=\sqrt{\frac{1}{\tau-1} \sum_{t=1}^{\tau}\left(b_{t}-\overline{b}\right)^{2}}
$$
其中$\tau$是测试窗口大小，可以设置成滚动窗口。

我们期望$B\approx 1$。一般，我们会设置一个置信区间，95%置信区间对应的$B$的范围是$1 \pm \sqrt{2 / \tau}$



记住，偏差统计量适用于组合层面，接下来我们构造一些组合进行测试。

个股组合：以一只股票作为一个组合。我们可以计算测试窗口期内，股票的方差和协方差矩阵。将股票按照方差大小排序，我们得到下面这幅图。

![ori bias test](https://raw.githubusercontent.com/Casey1203/axioma-paper/master/note/img/ori_bias_test.png)

图(a)看到偏差统计量在1附近，表明个股的样本协方差$V_0$对个股层面的风险预测还不错。

随机组合：产生100个随机组合。他们的收益率为
$$
R_{t}^{l}=\sum_{n} \varepsilon_{n}^{l} f_{n t}
$$
上标$l$表示第$l$个组合，$\epsilon_n^l$表示第$l$个组合中第$n$只股票的权重，由标准正态分布采样得到，这个向量是均值为0，表示现金中性。图(b)表示这些组合的偏差统计量，它们均在1附近，表示样本协方差$V_0$对随机组合的风险预测还不错。

特征组合：对样本协方差$V_0$做对角化，使得它不在对角线上的元素为0。对角线上的元素表示特征组合的方差，而非对角线上元素为0，表明特征组合之间是两两不想关的。
$$
R_{t}^{k}=\sum_{n} u_{n t}^{k} f_{n t}
$$
其中上标$k$表示第$k$个特征组合，$R_t^k$表示特征组合$k$在第$t$天的收益率。$u_{nt}^k$表示特征组合$k$中第$n$个股票的权重。特征组合在经济上没有直接的含义，但是它和方差预测息息相关。

